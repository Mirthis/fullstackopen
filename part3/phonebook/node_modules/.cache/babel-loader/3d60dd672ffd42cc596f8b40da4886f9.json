{"ast":null,"code":"import _asyncToGenerator from\"/home/mirthis/fullstackopen/fso-repo/part3/phonebook/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/mirthis/fullstackopen/fso-repo/part3/phonebook/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/mirthis/fullstackopen/fso-repo/part3/phonebook/node_modules/@babel/runtime/regenerator/index.js\";import{useEffect,useState}from\"react\";import Filter from\"./components/Filter\";import PersonForm from\"./components/PersonForm\";import Persons from\"./components/Persons\";import personsService from\"./services/persons\";import Notification from\"./components/Notification\";import\"./index.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),persons=_useState2[0],setPersons=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),newName=_useState4[0],setNewName=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),newNumber=_useState6[0],setNewNumber=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),filter=_useState8[0],setFilter=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),notification=_useState10[0],setNotification=_useState10[1];var setNotificationObj=function setNotificationObj(message){var type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"success\";setNotification({message:message,type:type});setTimeout(function(){return setNotification(null);},5000);};var loadData=function loadData(){personsService.getAll().then(function(data){return setPersons(data);}).catch(function(err){return console.log(err);});};useEffect(loadData,[]);var updatePerson=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id,personData){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return personsService.update(id,personData);case 3:data=_context.sent;setPersons(persons.map(function(p){return p.id===data.id?data:p;}));setNotificationObj(\"Contact \\\"\".concat(data.name,\"\\\" updated!\"));_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);setNotificationObj(\"Error updating contact\",\"error\");console.log(_context.t0);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function updatePerson(_x,_x2){return _ref.apply(this,arguments);};}();var createPerson=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(personData){var data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return personsService.create(personData);case 3:data=_context2.sent;setPersons(persons.concat(data));setNotificationObj(\"New contact \\\"\".concat(data.name,\"\\\" added to the phonebook!\"));_context2.next=12;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);setNotificationObj(\"Error creating contact. Contact may no longer exist.\",\"error\");console.log(_context2.t0);case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return function createPerson(_x3){return _ref2.apply(this,arguments);};}();var deletePerson=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){var personName;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return personsService.delete_person(id);case 3:personName=persons.find(function(p){return p.id===id;}).name;setPersons(persons.filter(function(p){return p.id!==id;}));setNotificationObj(\"New contact \\\"\".concat(personName,\"\\\" removed from the phonebook!\"));_context3.next=12;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](0);setNotificationObj(\"Error deleting contact. Contact may no longer exist.\",\"error\");console.log(_context3.t0);case 12:case\"end\":return _context3.stop();}}},_callee3,null,[[0,8]]);}));return function deletePerson(_x4){return _ref3.apply(this,arguments);};}();var submitForm=function submitForm(e){e.preventDefault();var newPerson={name:newName,number:newNumber};var knownPerson=persons.find(function(i){return i.name===newName;});if(knownPerson){var msg=\"\".concat(newName,\" is already added to phonebook, replace the old number with a new one?\");if(!window.confirm(msg)){return;}updatePerson(knownPerson.id,newPerson);}else{createPerson(newPerson);}setNewName(\"\");setNewNumber(\"\");};var onNameChange=function onNameChange(e){setNewName(e.target.value);};var onNumberChange=function onNumberChange(e){setNewNumber(e.target.value);};var onFilterChange=function onFilterChange(e){setFilter(e.target.value);};var onDeleteClick=function onDeleteClick(e){var toDeleteId=+e.target.dataset.id;var toDeleteObj=persons.find(function(p){return p.id===toDeleteId;});if(window.confirm(\"Delete \".concat(toDeleteObj.name,\"?\"))){deletePerson(toDeleteId);}};var showPersons=filter===\"\"?persons:persons.filter(function(p){return p.name.toLowerCase().includes(filter.toLowerCase());});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Phonebook\"}),notification&&/*#__PURE__*/_jsx(Notification,{message:notification.message,type:notification.type}),/*#__PURE__*/_jsx(Filter,{onSubmit:submitForm,filter:filter,onFilterChange:onFilterChange}),/*#__PURE__*/_jsx(\"h3\",{children:\"add a new\"}),/*#__PURE__*/_jsx(PersonForm,{onSubmit:submitForm,onNameChange:onNameChange,onNumberChange:onNumberChange,name:newName,number:newNumber}),/*#__PURE__*/_jsx(\"h3\",{children:\"Numbers\"}),/*#__PURE__*/_jsx(Persons,{persons:showPersons,onDeleteClick:onDeleteClick})]});};export default App;","map":{"version":3,"sources":["/home/mirthis/fullstackopen/fso-repo/part3/phonebook/src/App.js"],"names":["useEffect","useState","Filter","PersonForm","Persons","personsService","Notification","App","persons","setPersons","newName","setNewName","newNumber","setNewNumber","filter","setFilter","notification","setNotification","setNotificationObj","message","type","setTimeout","loadData","getAll","then","data","catch","err","console","log","updatePerson","id","personData","update","map","p","name","createPerson","create","concat","deletePerson","delete_person","personName","find","submitForm","e","preventDefault","newPerson","number","knownPerson","i","msg","window","confirm","onNameChange","target","value","onNumberChange","onFilterChange","onDeleteClick","toDeleteId","dataset","toDeleteObj","showPersons","toLowerCase","includes"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport Filter from \"./components/Filter\";\nimport PersonForm from \"./components/PersonForm\";\nimport Persons from \"./components/Persons\";\nimport personsService from \"./services/persons\";\nimport Notification from \"./components/Notification\";\nimport \"./index.css\";\n\nconst App = () => {\n  const [persons, setPersons] = useState([]);\n  const [newName, setNewName] = useState(\"\");\n  const [newNumber, setNewNumber] = useState(\"\");\n  const [filter, setFilter] = useState(\"\");\n  const [notification, setNotification] = useState(null);\n\n  const setNotificationObj = function (message, type = \"success\") {\n    setNotification({ message, type });\n    setTimeout(() => setNotification(null), 5000);\n  };\n\n  const loadData = () => {\n    personsService\n      .getAll()\n      .then((data) => setPersons(data))\n      .catch((err) => console.log(err));\n  };\n\n  useEffect(loadData, []);\n\n  const updatePerson = async (id, personData) => {\n    try {\n      const data = await personsService.update(id, personData);\n      setPersons(persons.map((p) => (p.id === data.id ? data : p)));\n      setNotificationObj(`Contact \"${data.name}\" updated!`);\n    } catch (err) {\n      setNotificationObj(\"Error updating contact\", \"error\");\n      console.log(err);\n    }\n  };\n\n  const createPerson = async (personData) => {\n    try {\n      const data = await personsService.create(personData);\n      setPersons(persons.concat(data));\n      setNotificationObj(`New contact \"${data.name}\" added to the phonebook!`);\n    } catch (err) {\n      setNotificationObj(\n        \"Error creating contact. Contact may no longer exist.\",\n        \"error\"\n      );\n      console.log(err);\n    }\n  };\n\n  const deletePerson = async function (id) {\n    try {\n      await personsService.delete_person(id);\n      const personName = persons.find((p) => p.id === id).name;\n      setPersons(persons.filter((p) => p.id !== id));\n      setNotificationObj(\n        `New contact \"${personName}\" removed from the phonebook!`\n      );\n    } catch (err) {\n      setNotificationObj(\n        \"Error deleting contact. Contact may no longer exist.\",\n        \"error\"\n      );\n      console.log(err);\n    }\n  };\n\n  const submitForm = (e) => {\n    e.preventDefault();\n    const newPerson = {\n      name: newName,\n      number: newNumber,\n    };\n    const knownPerson = persons.find((i) => i.name === newName);\n    if (knownPerson) {\n      const msg = `${newName} is already added to phonebook, replace the old number with a new one?`;\n      if (!window.confirm(msg)) {\n        return;\n      }\n      updatePerson(knownPerson.id, newPerson);\n    } else {\n      createPerson(newPerson);\n    }\n    setNewName(\"\");\n    setNewNumber(\"\");\n  };\n\n  const onNameChange = (e) => {\n    setNewName(e.target.value);\n  };\n\n  const onNumberChange = (e) => {\n    setNewNumber(e.target.value);\n  };\n\n  const onFilterChange = (e) => {\n    setFilter(e.target.value);\n  };\n\n  const onDeleteClick = (e) => {\n    const toDeleteId = +e.target.dataset.id;\n    const toDeleteObj = persons.find((p) => p.id === toDeleteId);\n    if (window.confirm(`Delete ${toDeleteObj.name}?`)) {\n      deletePerson(toDeleteId);\n    }\n  };\n\n  const showPersons =\n    filter === \"\"\n      ? persons\n      : persons.filter((p) =>\n          p.name.toLowerCase().includes(filter.toLowerCase())\n        );\n\n  return (\n    <div>\n      <h2>Phonebook</h2>\n      {notification && (\n        <Notification message={notification.message} type={notification.type} />\n      )}\n      <Filter\n        onSubmit={submitForm}\n        filter={filter}\n        onFilterChange={onFilterChange}\n      />\n      <h3>add a new</h3>\n      <PersonForm\n        onSubmit={submitForm}\n        onNameChange={onNameChange}\n        onNumberChange={onNumberChange}\n        name={newName}\n        number={newNumber}\n      />\n      <h3>Numbers</h3>\n      <Persons persons={showPersons} onDeleteClick={onDeleteClick} />\n    </div>\n  );\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}